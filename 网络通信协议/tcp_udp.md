# TCP / UDP 协议建立过程

## TCP
#### TCP 连接的建立需要三次握手
1. 客户端发送SYN（SEQ=x）报文给服务器端，进入SYN_SEND状态。
2. 服务器端收到SYN报文，回应一个SYN （SEQ=y）ACK(ACK=x+1）报文，进入SYN_RECV状态
3. 客户端收到服务器端的SYN报文，回应一个ACK(ACK=y+1）报文，进入Established状态
经过三次握手，客户端和服务器之间的链接就建立起来了。

#### TCP 连接的释放需要四次通讯

1. 某个应用进程首先调用close，称该端执行“主动关闭”（active close）。该端的TCP于是发送一个FIN分节，表示数据发送完毕。
2. 接收到这个FIN的对端执行 “被动关闭”（passive close），这个FIN由TCP确认。
3.  一段时间后，接收到这个文件结束符的应用进程将调用close关闭它的套接字。这导致它的TCP也发送一个FIN。
4.  接收这个最终FIN的原发送端TCP（即执行主动关闭的那一端）确认这个FIN。

#### TCP 是可靠的连接
    tcp数据包的可靠传输是通过以下几点来保证的：

1. 应用数据被分割成TCP认为最适合发送的数据块。
2. 当TCP发出一个段后，它启动一个定时器，等待目的端确认收到这个报文段。如果不能及时收到一个确认，将重发这个报文段。当TCP收到发自TCP连接另一端的数据，它将发送一个确认。
3. TCP将保持它首部和数据的检验和。如果校验不通过，则接收端不发送确认信息，让发送端重新发送信息报
4. TCP报文段作为IP数据报来传输，但是IP数据报的到达可能会存在失序的，因此TCP需要有一个报文排序的功能，按照发送顺序将数据重新组合起来，
5. IP数据报会出现重传的现象，所以TCP 应当有去重的功能
6. TCP还能提供流量控制。TCP连接的每一方都有固定大小的缓冲空间。TCP的接收端只允许另一端发送接收端缓冲区所能接纳的数据。这将防止较快主机致使较慢主机的缓冲区溢出。

>总结：tcp的可靠性总结一下就是 提供重传、数据校验、数据排序、数据去重，流量控制等功能。
优点是：可靠、安全。
缺点是：因为校验机制的存在而导致传输效率低下。

## UDP
    UDP其实没有什么可以讨论的，其实udp可以看做是携带端口数据的ip数据报，它没有tcp协议的各种可靠传输的控制在里面，只是提供了简单的数据封装和分发。

>总结： 优点是快速高效
        缺点是不安全可靠。









